@model UserManagement.Web.Models.Users.UserDetailsViewModel

@{
    ViewData["Title"] = "User Details";
}

<div class="container min-vh-100 d-flex justify-content-center align-items-center">
    <div class="col-md-6 col-lg-4">
        <div class="card shadow-sm p-4">
            <h2 class="mb-4 text-center">User Details</h2>

            <dl class="row">
                <dt class="col-sm-4">ID</dt>
                <dd class="col-sm-8">@Model.Id</dd>

                <dt class="col-sm-4">Full Name</dt>
                <dd class="col-sm-8">@Model.Forename @Model.Surname</dd>

                <dt class="col-sm-4">Email</dt>
                <dd class="col-sm-8">@Model.Email</dd>

                <dt class="col-sm-4">Date of Birth</dt>
                <dd class="col-sm-8">@Model.DateOfBirth</dd>

                <dt class="col-sm-4">Active?</dt>
                <dd class="col-sm-8">@(Model.IsActive ? "Yes" : "No")</dd>

                <dt class="col-sm-4">Logs</dt>
                <dd class="col-sm-8">
                    @if (Model.Logs != null && Model.Logs.Any())
                    {
                        <div class="dropdown">
                            <button class="btn btn-outline-secondary btn-sm dropdown-toggle w-100" type="button" id="logsDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                View Logs (@Model.Logs.Count)
                            </button>
                            <ul class="dropdown-menu p-2" aria-labelledby="logsDropdown" style="max-height: 300px; overflow-y: auto; width: 400px;">
                                @foreach (var log in Model.Logs)
                                {
                                    <li class="dropdown-item" style="white-space: normal; word-wrap: break-word;">
                                        <strong>@log.Timestamp.ToString("g"):</strong>
                                        <span>@log.Action</span>
                                        @if (!string.IsNullOrEmpty(log.Details))
                                        {
                                            <div class="text-muted small mt-1">
                                                @Html.Raw(log.Details.Replace("; ", ";<br />"))
                                            </div>
                                        }
                                    </li>
                                }
                            </ul>
                        </div>
                    }
                    else
                    {
                        <span>No logs found for this user.</span>
                    }
                </dd>
            </dl>
            <a asp-controller="Users" asp-action="List" class="btn btn-primary float-end w-100">Back to List</a>
        </div>
    </div>
</div>
